ソフト名：WeaponChange20061105v001b002
名称：武器自動換装パッチ20061105v001b002
バージョン：20061105v001b002
型番：2006年11月05日発行001号ベータ002
作者：ghost127


■用途
X operations ONLINE - version test 1.8サーバ用パッチ。
これ自体はXopsを起動してからパッチをメモリ上で当てるプログラム。
よって他のパッチ適応済みExeとの競合は少なめ。
パッチ内容は
　マップ開始時マップ配置武器変更
　マップ開始時マップ配置武器消去
　マップ開始時キャラクター装備武器変更
　マップ開始時キャラクター初期装備強制
以上。
変更は対応テーブルによる。テーブルは一種のみで装弾数も設定できる。

■簡易用法
注：Exeは本ソフト、XopsはXops実行ファイル。
1、設定ファイル(Ini)を用意する。一度起動すれば標準設定が出力される。
2、Exeを起動する。手法は4種。起動成否無視でIniにファイル名を記録する。
2-1、Exeを起動する。その際XopsはIniに従う。
2-2、XopsフォルダにExeを持ってきて実行する。xopsolt18.exeが起動される。
2-3、ExeにXopsをドラッグアンドドロップする。
2-4、3の亜種。コマンドプロンプトでExeにパラメータとしてXopsを指定する。
3、メッセージ音が鳴ります。システムエラーの音だったら失敗です。
4、普通にサーバを立てる。


■設定ファイル書式
WindowsAPIで読み書き出来るIniファイル。
ファイル名は実行ファイルと同名でIni拡張子。
サンプルは一度起動して出力されるファイルで。
以下、キー名と意味
Exe=実行するXopsファイル名
Change=Map配置武器の変更の有無、有無の指定は有効で1、無効で0
ChangesRate=武器を変更した場合、装弾数と掛けた値が予備弾数になる
AutoEquip=無手のキャラに与える武器ID
ReEquip=初期装備の変更の有無
Delete=Mapから武器の消去の有無
Wxxx=武器IDxxxの武器を変更する場合の武器ID
Bxxx=武器IDxxxの武器を変更する場合の装弾数

ID一覧
NONE        :00
MP5         :01
PSG1        :02
M92F        :03
GLOCK18 SEMI:04
DESERT EAGLE:05
MAC10       :06
UMP         :07
P90         :08
M4          :09
AK47        :10
AUG         :11
M249        :12
GRENADE     :13
MP5SD       :14
CASE        :15
GLOCK18 FULL:16
M1911       :17
GLOCK17     :18
M1          :19
FAMAS       :20
MK23        :21
MK23 SD     :22

■説明
*起動時にコマンドライン、Iniファイル、同じフォルダのxopsolt18.exeの順で
　起動するXopsを変更する。
よってファイル名の違うXopsでも実行可能。
*装備品の変更、Map配置武器の変更ともに同じルールで行われる。
*Map武器変更ではキャラクタID0のキャラクタに全て装備させることで、古い武
　器を消去している。
装備された武器を消す方法は取れていないので、考慮すること。
*副装備は変更できない。

■トラブルシューティング
Q：「quit(fill)」が多発する。
A：fillはおそらくパケット用バッファオーバの警告をかねた切断です。
　対策コードを追加したのでfillが発生する状況でも、サーバのメイン処理が
　遅延するだけですむようになった筈です。

Q：サーバで見ると武器を装備しているがクライアントは装備していなく、武器
　が拾えなくなることがある。
A：パッチの不具合です。発生条件や原因が分かる方は教えてください。
とりあえず、武器を持ち替えると回復するようです。

Q：起動時にエラー音がしてパッチが機能しない。
A：Xopsの指定がうまくいっていないか、パッチを当てる部分がオリジナルと違
　うか、パッチをXopsに組み込めなかったかです。3つ目の場合対処は困難です。
　いずれ統合型のカスタマイズ環境を作りたいのでそちらでは解決します。

Q：ベータとなっているがいつか正式版になるのか
A：なる予定はなさそうです。Xopsもtest版ですしおそらく永久に。

Q：ぶっちゃけハンドガン鯖専用か？
A：別のツールの副産物で、ハンドガン鯖向けを考えて作りました。

Q：クラッシュした。
A：ベータ版ですのでご了承ください。自己責任でお願いします。

Q：作者の許可は？
A：ありません。自己責任でお願いします。

Q：着発GRE255:255とか面白くね？
A：自己責任でお願いします。

Q：データが飛んだ。
A：自己責任でお願いします。

Q：サーバの受けが悪かった。
A：自己責任でお願いします。

Q：損害を受けた。
A：自己責任でお願いします。

Q：重い。
A：自己責任でお願いします。

Q：自己責任ばかりか。
A：自己責任でお願いします。

M:終われ。

■更新履歴
20061104v001b000
　*初版。
　*吶喊作業気味に形にした。
　*時間も無かったので不具合を使用不能ということにした。
20061104v001b001
　*quit(fill)についての解析と対策。
　それによって開始時の武器交換ラグが増え、(fill)発生が減少。
　確認した限りで(fill)は発生していない。
　*手作業で設定していた初期設定でFAMAS→MK23の装弾数が間違っていたので、
　機械的に出力しなおした。
　*武器消去は問題なかったのでテキスト修正。
　*キャラクター装備の変更に関わるコードでかなり馬鹿なミスがあったため
　修正した。(alpha版から改善するつもりで違う値を書き換えていた)。
　装備武器変更、初期装備強制はこれで使えるようになったはず。
　*リリースに向けて吶喊作業だった部分は解決したはず。
　*このテキストに更新履歴追加。
　*トラブルシューティング修正。
　*D&Dで起動できないのを忘れていたのですぐさま撤回して再公開。
20061105v001b002
　*多分起こりうると思っていたバグ、「一人だけMapに落ちていた置き換え前
　の武器を拾う」が確認できたので修正。見辛い修正コードとなった。
　*当初の懸案事項は大方修正できた。

